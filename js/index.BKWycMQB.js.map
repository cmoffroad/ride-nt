{"version":3,"file":"index.BKWycMQB.js","sources":["../../app/js/config.js","../../app/js/auth.js","../../app/js/layers.js","../../app/js/transparency.js","../../app/js/mapSetup.js","../../app/js/legend.js","../../app/js/contextMenu.js","../../app/js/gpxDragDrop.js","../../app/js/keyboard.js","../../app/js/draw.js","../../app/js/index.js"],"sourcesContent":["// Auto-generated config file\nexport const isDev = location.protocol.startsWith('file');\n\nexport const clipBounds = {\n  \"minLat\": 16.5,\n  \"maxLat\": 20.5,\n  \"minLon\": 97.5,\n  \"maxLon\": 103\n};\n\nexport const regionBounds = [\n  [clipBounds.minLat, clipBounds.minLon],\n  [clipBounds.maxLat, clipBounds.maxLon]\n];\n\nexport const colors = {\n  \"fast\": \"rgba(0, 140, 60, 1)\",\n  \"moderate\": \"rgba(255, 179, 0, 1)\",\n  \"slow\": \"rgba(255, 40, 40, 1)\",\n  \"veryTechnical\": \"rgba(128, 0, 128, 1)\",\n  \"maybe\": \"rgba(180, 180, 180, 1)\",\n  \"likely\": \"rgba(100, 100, 100, 1)\",\n  \"paved\": \"rgba(51, 102, 255, 1)\",\n  \"residential\": \"rgba(160, 140, 120, 0.5)\"\n};\n\nexport const timestamp = 1752636342365;\n\nexport const minZoom = 10;\nexport const maxZoom = 13;\n  ","const PASSWORD = 'UmlkZVNhZmUyMDI1IQ==';\nconst STORAGE_KEY_AUTH = 'rident_auth';\nconst ONE_MONTH_MS = 30 * 24 * 60 * 60 * 1000;\n\nexport function isPasswordValid() {\n  const stored = localStorage.getItem(STORAGE_KEY_AUTH);\n  if (!stored) return false;\n  try {\n    const { password, expires } = JSON.parse(stored);\n    return password === PASSWORD && Date.now() < expires;\n  } catch {\n    return false;\n  }\n}\n\nexport function storePassword() {\n  const expires = Date.now() + ONE_MONTH_MS;\n  localStorage.setItem(STORAGE_KEY_AUTH, JSON.stringify({ password: PASSWORD, expires }));\n}\n\nexport function promptPassword() {\n  if (!isPasswordValid()) {\n    const input = prompt('Enter password to view the map:');\n    if (input !== atob(PASSWORD)) {\n      alert('Incorrect password. Access denied.');\n      document.body.innerHTML = \"<h2 style='text-align:center;margin-top:20%'>Access Denied</h2>\";\n      // document.body.classList.remove('locked');\n      // throw new Error('Unauthorized');\n    } else {\n      storePassword();\n      // document.body.classList.remove('locked');\n    }\n  }\n  document.body.classList.remove('locked');\n}\n","import { isDev, timestamp, minZoom, maxZoom } from './config.js';\n\nexport const mainOverlay = L.tileLayer(\n  `https://julcnx.github.io/tiles/heatmap/ride/{z}/{x}/{y}.png?ts=${timestamp}`,\n  {\n    tileSize: 256,\n    minNativeZoom: minZoom,\n    maxNativeZoom: maxZoom,\n    zIndex: 3,\n    attribution: `Ride NT`,\n    id: 'ride-nt',\n  }\n);\n\nexport const mainOverlayDev = L.tileLayer(\n  `../../tiles/heatmap/ride/{z}/{x}/{y}.png?ts=${timestamp}`,\n  {\n    tileSize: 256,\n    minNativeZoom: minZoom,\n    maxNativeZoom: maxZoom,\n    zIndex: 2,\n    attribution: `Ride NT (Dev)`,\n    id: 'ride-nt-dev',\n  }\n);\n\nfunction createDRRLayer(attribution, layers) {\n  return L.tileLayer.wms(\n    'https://gisportal.drr.go.th/portal/sharing/servers/aa5fdea8d96542d49d3d8731d77458b7/rest/services/GISBaseMaps/DRR_Dynamic/MapServer/export',\n    {\n      transparent: true,\n      attribution,\n      format: 'png',\n      layers,\n      bboxSR: 102100,\n      f: 'image',\n      className: 'overlay',\n    }\n  );\n}\n\nconst DRR_DYNAMIC_LAYERS = {\n  all: createDRRLayer('DRR (All)', 'show:1,2,3,4,5,6,7'),\n  highways: createDRRLayer('DRR (Highways)', 'show:-1,-1,-1,3'),\n  majorHighways: createDRRLayer('DRR (Highways Major)', 'show:-1,-1,-1,2'),\n  ruralRoads: createDRRLayer('DRR (Rural Roads)', 'show:-1,-1,-1,7'),\n};\n\nconst GOOGLE_LAYERS = { satellite: 's', terrain: 'p', hybrid: 'h', maps: 'm' };\n\nconst googleSatellite = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.satellite}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Satellite`,\n    id: 'google-satellite',\n  }\n);\n\nconst googleMaps = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.maps}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Maps`,\n    id: 'google-maps',\n  }\n);\n\nconst googleTerrain = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.terrain}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    attribution: `Google Terrain`,\n    id: 'google-terrain',\n  }\n);\n\nconst googleHybrid = L.tileLayer(\n  `https://mt{s}.google.com/vt?lyrs=${GOOGLE_LAYERS.hybrid}&x={x}&y={y}&z={z}`,\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 18,\n    transparent: true,\n    zIndex: 2,\n    attribution: `Google Hybrid`,\n    id: 'google-hybrid',\n  }\n);\n\nconst esriFirefly = L.esri.basemapLayer('ImageryFirefly', {\n  maxNativeZoom: 18,\n  attribution: `ESRI Firefly`,\n  id: 'esri-firefly',\n});\n\nconst esriClarity = L.esri.basemapLayer('ImageryClarity', {\n  maxNativeZoom: 17,\n  attribution: `ESRI Clarity`,\n  id: 'esri-clarity',\n});\n\nconst esriWayback = L.tileLayer(\n  'https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/WMTS/1.0.0/default028mm/MapServer/tile/10/{z}/{y}/{x}',\n  {\n    maxNativeZoom: 17,\n    attribution: `ESRI Wayback`,\n    id: 'esri-wayback',\n  }\n);\n\nconst thunderforestTransport = L.tileLayer(\n  'https://{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=6e5478c8a4f54c779f85573c0e399391',\n  {\n    attribution: `Thunderforest Transport`,\n    maxNativeZoom: 18,\n    subdomains: 'abc',\n  }\n);\n\nconst thunderforestCycle = L.tileLayer(\n  'https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=6e5478c8a4f54c779f85573c0e399391',\n  {\n    attribution: `Thunderforest Transport`,\n    maxNativeZoom: 18,\n    subdomains: 'abc',\n    id: 'thunderforest-cyclemap',\n  }\n);\n\nconst osmStandard = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n  subdomains: ['a', 'b', 'c'],\n  attribution: `OSM Contributors`,\n  id: 'openstreetmap',\n});\n\nconst worldTopoMap = L.tileLayer(\n  'https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n  {\n    attribution: `WorldTopoMap`,\n    maxNativeZoom: 18,\n    id: 'worldtopomap',\n  }\n);\n\nconst rtsMap = L.tileLayer(`../../tiles/50k/{z}/{x}/{y}.png`, {\n  attribution: `50K`,\n  minNativeZoom: 13,\n  maxNativeZoom: 14,\n  id: '50k',\n});\n\nconst googleStreetViewTiles = L.tileLayer(\n  'https://mts{s}.googleapis.com/vt?hl=en-US&lyrs=svv|cb_client:apiv3&style=40,18&x={x}&y={y}&z={z}',\n  {\n    subdomains: ['0', '1', '2', '3'],\n    maxNativeZoom: 13,\n    maxZoom: 20,\n    // opacity: 0.7,\n    zIndex: 1,\n    className: 'overlay',\n    attribution: `Google Street View`,\n  }\n);\n\nconst mapillaryVector = L.vectorGrid.protobuf(\n  'https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token=MLY|4100327730013843|5bb78b81720791946a9a7b956c57b7cf',\n  {\n    transparent: true,\n    maxNativeZoom: 13,\n    zIndex: 1,\n    className: 'overlay',\n    attribution: `Mapillary`,\n    vectorTileLayerStyles: {\n      sequence: () => ({\n        color: 'rgb(20, 150, 60)',\n        weight: 10,\n        // opacity: 0.7,\n      }),\n    },\n  }\n);\n\nconst kartaViewTiles = L.tileLayer(\n  'https://karta-gateway.geo.azure.myteksi.net/view/api/2.0/sequence/tiles/{x}/{y}/{z}.png',\n  {\n    transparent: true,\n    minNativeZoom: 13,\n    maxNativeZoom: 20,\n    className: 'overlay',\n    attribution: `KartaView`,\n  }\n);\n\nconst stravaHeatmapAll = L.tileLayer(\n  'https://content-{s}.strava.com/identified/globalheat/all/hot/{z}/{x}/{y}.png?v=19',\n  {\n    subdomains: ['a'],\n    maxNativeZoom: 14,\n    zIndex: 2,\n    className: 'overlay',\n    attribution: `Strava Heatmap All`,\n  }\n);\n\nconst stravaHeatmapRide = L.tileLayer(\n  'https://content-{s}.strava.com/identified/globalheat/ride/purple/{z}/{x}/{y}.png?v=19',\n  {\n    subdomains: ['a'],\n    maxNativeZoom: 14,\n    zIndex: 2,\n    className: 'overlay',\n    attribution: `Strava Heatmap Ride`,\n  }\n);\n\nconst osmGpsTraces = L.tileLayer('https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png', {\n  transparent: true,\n  maxNativeZoom: 18,\n  zIndex: 2,\n  className: 'overlay',\n  attribution: `OSM GPS Traces`,\n});\n\nexport const baseLayers = {\n  'World Topo Map': worldTopoMap,\n  'OSM Standard': osmStandard,\n  'Google Maps': googleMaps,\n  'Google Terrain': googleTerrain,\n  'Transport Map': thunderforestTransport,\n  'Cycle Map': thunderforestCycle,\n};\n\nif (isDev) {\n  baseLayers['RTS Map'] = rtsMap;\n}\n\nexport const satelliteLayers = {\n  'Google Satellite': googleSatellite,\n  'ESRI Firefly': esriFirefly,\n  'ESRI Clarity': esriClarity,\n  'ESRI Wayback': esriWayback,\n};\n\nexport const overlays = {\n  'OpenStreetMap traces': osmGpsTraces,\n};\n\n// Add additional layers for development mode\n// These layers are not included in production to keep the map clean and focused on essential data.\n// They are useful for testing and development purposes, providing additional context or data layers.\nif (isDev) {\n  overlays['Google Street View'] = googleStreetViewTiles;\n  overlays['Google Hybrid'] = googleHybrid;\n  overlays.Mapillary = mapillaryVector;\n  overlays.KartaView = kartaViewTiles;\n  overlays['Strava Heatmap (All)'] = stravaHeatmapAll;\n  overlays['Strava Heatmap (Ride)'] = stravaHeatmapRide;\n  overlays['DRR (All)'] = DRR_DYNAMIC_LAYERS.all;\n}\n","import { mainOverlay, overlays, satelliteLayers } from './layers.js';\n\nexport let baseLayerTransparency = 0;\n\nexport function addBaseLayerTransparencyControl(map) {\n  const baseControl = L.control({ position: 'topleft' }); // Or 'topleft' if needed\n\n  baseControl.onAdd = function () {\n    const div = L.DomUtil.create(\n      'div',\n      'leaflet-control leaflet-top-center leaflet-control-layers leaflet-control-layers-expanded transparency-toolbar'\n    );\n\n    // --- Dropdown ---\n    const select = L.DomUtil.create('select', '', div);\n    select.className = 'transparency-select';\n\n    Object.keys(satelliteLayers).forEach(label => {\n      const option = document.createElement('option');\n      option.value = label;\n      option.textContent = label;\n      select.appendChild(option);\n    });\n\n    const savedName = localStorage.getItem('rident_satellite');\n    const defaultName =\n      savedName && satelliteLayers[savedName] ? savedName : Object.keys(satelliteLayers)[0];\n\n    select.value = defaultName;\n\n    let currentSatelliteLayer = satelliteLayers[defaultName];\n    currentSatelliteLayer.addTo(map);\n    currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n    currentSatelliteLayer.setZIndex(1);\n\n    // --- Slider ---\n    const input = L.DomUtil.create('input', '', div);\n    input.className = 'transparency-slider';\n    input.type = 'range';\n    input.min = 0;\n    input.max = 100;\n    input.step = 1;\n    input.value = baseLayerTransparency;\n\n    // --- Handlers ---\n    L.DomEvent.on(input, 'input', e => {\n      const value = parseFloat(e.target.value);\n      baseLayerTransparency = value;\n\n      const effectiveOpacity = (100 - value) / 100;\n\n      // const overlayPane = document.querySelector(\n      //   \".leaflet-pane.leaflet-overlay-pane\"\n      // );\n      // overlayPane.style.opacity = effectiveOpacity;\n\n      // mainOverlay.setOpacity(effectiveOpacity);\n\n      // Update all overlays\n      // Object.values(overlays).forEach((layer) => {\n      //   if (typeof layer.setOpacity === \"function\") {\n      //     layer.setOpacity(effectiveOpacity);\n      //   }\n      // });\n\n      if (currentSatelliteLayer) {\n        currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n      }\n\n      input.blur(); // Remove focus to prevent slider from sticking\n    });\n\n    L.DomEvent.on(select, 'change', e => {\n      const selectedName = e.target.value;\n      if (map.hasLayer(currentSatelliteLayer)) {\n        map.removeLayer(currentSatelliteLayer);\n      }\n      currentSatelliteLayer = satelliteLayers[selectedName];\n      currentSatelliteLayer.addTo(map);\n      currentSatelliteLayer.setOpacity(baseLayerTransparency / 100);\n      currentSatelliteLayer.setZIndex(1);\n      localStorage.setItem('rident_satellite', selectedName);\n    });\n\n    L.DomEvent.disableClickPropagation(div);\n\n    select.blur();\n    return div;\n  };\n\n  baseControl.addTo(map);\n}\n","import { regionBounds } from './config.js';\nimport { mainOverlay, mainOverlayDev, baseLayers, satelliteLayers, overlays } from './layers.js';\nimport { baseLayerTransparency } from './transparency.js';\n\nconst STORAGE_KEY_VIEW = 'rident_map_view';\nconst STORAGE_KEY_BASE = 'rident_base_layer';\nconst STORAGE_KEY_SATELLITE = 'rident_satellite';\nconst STORAGE_KEY_OVERLAYS = 'rident_overlays';\n\nexport function initializeMap() {\n  document.getElementById('map').style.display = 'block';\n\n  const map = createMap();\n  setInitialView(map);\n\n  const layersControl = L.control\n    .layers(baseLayers, overlays, {\n      collapsed: true,\n      autoZIndex: false,\n      position: 'topright',\n    })\n    .addTo(map);\n\n  const { currentBaseLayer, currentSatelliteLayer } = restoreLayerSelection(map);\n  setupEventListeners(map);\n\n  return {\n    map,\n    layersControl,\n  };\n}\n\nfunction createMap() {\n  const map = L.map('map', {\n    minZoom: 9,\n    maxBounds: L.latLngBounds(regionBounds),\n    layers: [mainOverlay],\n    zoomControl: true,\n    maxZoom: 18,\n    attributionControl: true,\n  });\n  map.attributionControl.setPrefix('');\n\n  return map;\n}\n\nfunction setInitialView(map) {\n  const hashMatch = location.hash.match(/^#(\\d+)\\/([-\\d.]+)\\/([-\\d.]+)$/);\n  if (hashMatch) {\n    const zoom = +hashMatch[1];\n    const lat = +hashMatch[2];\n    const lng = +hashMatch[3];\n    map.setView([lat, lng], zoom);\n    return;\n  }\n\n  const saved = localStorage.getItem(STORAGE_KEY_VIEW);\n  if (saved) {\n    try {\n      const { center, zoom } = JSON.parse(saved);\n      map.setView(center, zoom);\n      return;\n    } catch {}\n  }\n\n  map.setView([18.79, 98.98], 10);\n}\n\nfunction restoreLayerSelection(map) {\n  let currentBaseLayer;\n\n  // Restore or fallback base layer\n  const baseName = localStorage.getItem(STORAGE_KEY_BASE);\n  if (baseName && baseLayers[baseName]) {\n    baseLayers[baseName].addTo(map);\n    currentBaseLayer = baseLayers[baseName];\n  } else {\n    baseLayers['World Topo Map'].addTo(map);\n    currentBaseLayer = baseLayers['World Topo Map'];\n  }\n\n  // Restore overlays\n  const overlayJSON = localStorage.getItem(STORAGE_KEY_OVERLAYS);\n  let savedOverlays = [];\n  try {\n    savedOverlays = overlayJSON ? JSON.parse(overlayJSON) : [];\n  } catch {}\n\n  if (savedOverlays.length) {\n    for (const [name, layer] of Object.entries(overlays)) {\n      if (savedOverlays.includes(name)) {\n        layer.addTo(map);\n      }\n    }\n  }\n\n  // Restore or default satellite layer\n  const satName = localStorage.getItem(STORAGE_KEY_SATELLITE);\n  let currentSatelliteLayer;\n  if (satName && satelliteLayers[satName]) {\n    currentSatelliteLayer = satelliteLayers[satName];\n  } else {\n    currentSatelliteLayer = satelliteLayers['Google Satellite'];\n  }\n\n  if (currentSatelliteLayer) {\n    currentSatelliteLayer.setOpacity(baseLayerTransparency / 100.0);\n    currentSatelliteLayer.addTo(map);\n  }\n\n  return { currentBaseLayer, currentSatelliteLayer };\n}\n\nfunction setupEventListeners(map) {\n  map.on('baselayerchange', e => {\n    const selectedBaseLayer = Object.entries(baseLayers).find(([_, v]) => v === e.layer);\n    if (selectedBaseLayer) {\n      localStorage.setItem(STORAGE_KEY_BASE, selectedBaseLayer[0]);\n      selectedBaseLayer[1].setZIndex(0);\n    }\n\n    const selectedSatLayer = Object.entries(satelliteLayers).find(([_, v]) => v === e.layer);\n    if (selectedSatLayer) {\n      localStorage.setItem(STORAGE_KEY_SATELLITE, selectedSatLayer[0]);\n      selectedSatLayer[1].setZIndex(1);\n      selectedSatLayer[1].setOpacity(baseLayerTransparency / 100);\n    }\n  });\n\n  map.on('overlayadd overlayremove', () => {\n    const activeOverlays = Object.entries(overlays)\n      .filter(([_, layer]) => map.hasLayer(layer))\n      .map(([name]) => name);\n    localStorage.setItem(STORAGE_KEY_OVERLAYS, JSON.stringify(activeOverlays));\n  });\n\n  map.on('moveend zoomend', () => {\n    const center = map.getCenter();\n    const zoom = map.getZoom();\n    const hash = `#${zoom}/${center.lat.toFixed(6)}/${center.lng.toFixed(6)}`;\n    location.hash = hash;\n    localStorage.setItem(STORAGE_KEY_VIEW, JSON.stringify({ center, zoom }));\n  });\n}\n","import { colors } from './config.js';\n\nexport function addLegend(map) {\n  const legend = L.control({ position: 'bottomright' });\n\n  legend.onAdd = function () {\n    const container = L.DomUtil.create('div', 'info legend');\n    container.style.position = 'relative';\n    container.style.transition = 'all 0.3s ease';\n    container.style.fontSize = '14px';\n    container.style.color = '#333';\n    container.style.maxWidth = '250px';\n\n    const opacity = 1;\n    const storageKey = 'rideNT-legend-visible';\n    let isVisible = false;\n\n    function colorBox(color) {\n      return `<span style=\"\n\t\t\t\tdisplay:inline-block;\n\t\t\t\twidth:14px;\n\t\t\t\theight:10px;\n\t\t\t\tmargin-right:8px;\n\t\t\t\tbackground-color:${color};\n\t\t\t\tvertical-align:middle;\n\t\t\t\"></span>`;\n    }\n\n    // --- Full panel content\n    const panel = document.createElement('div');\n    panel.style.background = 'rgba(255, 255, 255, 0.95)';\n    panel.style.borderRadius = '6px';\n    panel.style.padding = '8px';\n    panel.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';\n    panel.style.display = 'none';\n    panel.style.flexDirection = 'column';\n\n    const header = document.createElement('div');\n    header.style.display = 'flex';\n    header.style.justifyContent = 'space-between';\n    header.style.alignItems = 'center';\n    header.style.marginBottom = '6px';\n\n    const title = document.createElement('span');\n    title.textContent = 'RideNT Legend';\n    title.style.fontWeight = 'bold';\n\n    const collapseBtn = document.createElement('a');\n    collapseBtn.href = '#';\n    collapseBtn.innerHTML = '🔽';\n    collapseBtn.title = 'Collapse legend';\n    collapseBtn.style.fontSize = '18px';\n    collapseBtn.style.textDecoration = 'none';\n    collapseBtn.style.cursor = 'pointer';\n    collapseBtn.style.padding = '4px';\n\n    collapseBtn.onclick = e => {\n      e.preventDefault();\n      isVisible = false;\n      updateVisibility();\n    };\n\n    header.appendChild(title);\n    header.appendChild(collapseBtn);\n\n    const content = document.createElement('div');\n    content.innerHTML = `\n\t\t\t${colorBox(colors.paved)} Paved<br>\n\t\t\t${colorBox(colors.fast)} Fast dirt<br>\n\t\t\t${colorBox(colors.moderate)} Moderate dirt<br>\n\t\t\t${colorBox(colors.slow)} Slow / Technical<br>\n\t\t\t${colorBox(colors.veryTechnical)} Very technical<br>\n\t\t\t${colorBox(colors.likely)} Rural roads<br>\n\t\t\t${colorBox(colors.maybe)} Uncertain trails<br>\n\t\t\t<br>\n\t\t\t<span class=\"caption\">Speeds are approximate, based on dry GPX tracks with climate & rider factors considered. Accuracy not guaranteed.</span>\n\t\t`;\n\n    panel.appendChild(header);\n    panel.appendChild(content);\n\n    // --- Floating icon button (only shown when collapsed)\n    const iconBtn = document.createElement('a');\n    iconBtn.href = '#';\n    iconBtn.innerHTML = '❓';\n    iconBtn.title = 'Show legend';\n    iconBtn.style.display = 'none';\n    iconBtn.style.textDecoration = 'none';\n    iconBtn.style.fontSize = '20px';\n    iconBtn.style.width = '36px';\n    iconBtn.style.height = '36px';\n    iconBtn.style.textAlign = 'center';\n    iconBtn.style.lineHeight = '36px';\n    iconBtn.style.borderRadius = '6px';\n    iconBtn.style.background = 'white';\n    iconBtn.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';\n    iconBtn.style.cursor = 'pointer';\n\n    iconBtn.onclick = e => {\n      e.preventDefault();\n      isVisible = true;\n      updateVisibility();\n    };\n\n    function updateVisibility() {\n      panel.style.display = isVisible ? 'flex' : 'none';\n      iconBtn.style.display = isVisible ? 'none' : 'inline-block';\n    }\n\n    updateVisibility();\n\n    container.appendChild(panel);\n    container.appendChild(iconBtn);\n\n    return container;\n  };\n\n  legend.addTo(map);\n}\n","import { isDev } from './config.js';\n\nimport { baseLayers, satelliteLayers } from './layers';\n\nfunction showToast(message, duration = 2000) {\n  const toast = document.createElement('div');\n  toast.innerText = message;\n  toast.style.position = 'fixed';\n  toast.style.bottom = '20px';\n  toast.style.left = '50%';\n  toast.style.transform = 'translateX(-50%)';\n  toast.style.background = 'rgba(0,0,0,0.8)';\n  toast.style.color = '#fff';\n  toast.style.padding = '8px 12px';\n  toast.style.borderRadius = '6px';\n  toast.style.fontSize = '14px';\n  toast.style.zIndex = 9999;\n  toast.style.opacity = 0;\n  toast.style.transition = 'opacity 0.3s ease';\n\n  document.body.appendChild(toast);\n\n  // fade in\n  requestAnimationFrame(() => {\n    toast.style.opacity = 1;\n  });\n\n  setTimeout(() => {\n    toast.style.opacity = 0;\n    setTimeout(() => {\n      document.body.removeChild(toast);\n    }, 300);\n  }, duration);\n}\n\nexport function addContextMenu(map) {\n  const contextMenu = document.getElementById('context-menu');\n\n  function addMenuItem(label, action) {\n    const item = document.createElement('div');\n    item.innerText = label;\n    item.style.padding = '4px 8px';\n    item.style.cursor = 'pointer';\n    item.onmouseenter = () => (item.style.background = '#eee');\n    item.onmouseleave = () => (item.style.background = '');\n    item.onmousedown = () => {\n      action();\n      contextMenu.style.display = 'none';\n    };\n    contextMenu.appendChild(item);\n  }\n\n  function addSeparator() {\n    const hr = document.createElement('hr');\n    hr.style.margin = '0';\n    contextMenu.appendChild(hr);\n  }\n\n  map.on('contextmenu', function (e) {\n    const lat = e.latlng.lat.toFixed(6);\n    const lng = e.latlng.lng.toFixed(6);\n    const z = map.getZoom();\n    const currentBaseLayer = Object.values(baseLayers).find(v => map.hasLayer(v));\n    const currentSatelliteLayer = Object.values(satelliteLayers).find(v => map.hasLayer(v));\n    contextMenu.innerHTML = '';\n\n    addMenuItem('Edit in OpenStreetMap', () => {\n      window.open(\n        `https://www.openstreetmap.org/id?#map=${Math.max(16, map.getZoom())}/${lat}/${lng}`\n      );\n    });\n\n    addSeparator();\n\n    addMenuItem('Open in Google Maps', () => {\n      const params = new URLSearchParams({\n        api: 1,\n        map_action: 'map',\n        basemap: 'terrain',\n        center: [lat, lng].join(','),\n        zoom: z,\n      });\n      window.open(`https://www.google.com/maps/@?${unescape(params)}`);\n    });\n\n    if (isDev) {\n      addMenuItem('Open in Google Street View', () => {\n        window.open(`https://www.google.com/maps?q=&layer=c&cbll=${lat},${lng}`);\n      });\n\n      addMenuItem('Open in Mapillary', () => {\n        const params = new URLSearchParams({ lat, lng, z });\n        window.open(`https://www.mapillary.com/app/?${unescape(params)}`);\n      });\n    }\n\n    addMenuItem('Open in Komoot', () => {\n      window.open(`https://www.komoot.com/plan/@${lat},${lng},${z}z?sport=mtb`);\n    });\n\n    addSeparator();\n\n    addMenuItem('Copy Coordinates', () => {\n      navigator.clipboard.writeText(`${lat}, ${lng}`).then(() => {\n        showToast('Coordinates copied to clipboard.');\n      });\n    });\n\n    addMenuItem('Get Elevation', () => {\n      fetch(`https://api.open-elevation.com/api/v1/lookup?locations=${lat},${lng}`)\n        .then(response => response.json())\n        .then(data => {\n          if (data.results && data.results.length > 0) {\n            const elevation = data.results[0].elevation;\n            showToast(`Elevation: ${elevation} meters`);\n          }\n        })\n        .catch(error => console.error('Error fetching elevation:', error));\n    });\n\n    addSeparator();\n\n    if (isDev) {\n      addMenuItem('Download OSM GPS traces', () => {\n        window.open(\n          'https://api.openstreetmap.org/api/0.6/trackpoints?bbox=' +\n            [\n              map.getBounds().getWest(),\n              map.getBounds().getSouth(),\n              map.getBounds().getEast(),\n              map.getBounds().getNorth(),\n            ].join(',') +\n            '&page=0'\n        );\n      });\n\n      addMenuItem('Generate SqliteDB', () => {\n        const bounds = map.getBounds();\n        const north = bounds.getNorth().toFixed(6);\n        const west = bounds.getWest().toFixed(6);\n        const south = bounds.getSouth().toFixed(6);\n        const east = bounds.getEast().toFixed(6);\n        const bboxString = `${north},${west},${south},${east}`;\n\n        let copyString;\n        if (currentSatelliteLayer?.options.opacity > 0) {\n          copyString = `node scripts/sqlitedb.js ./tmp/${\n            currentSatelliteLayer.options.id\n          }.sqlitedb '${currentSatelliteLayer._url.replace(\n            '{s}',\n            currentSatelliteLayer.options.subdomains[0]\n          )}' ${bboxString}`;\n        } else if (currentBaseLayer) {\n          copyString = `node scripts/sqlitedb.js ./tmp/${\n            currentBaseLayer.options.id\n          }.sqlitedb '${currentBaseLayer._url.replace(\n            '{s}',\n            currentBaseLayer.options.subdomains[0]\n          )}' ${bboxString}`;\n        }\n        if (copyString) {\n          navigator.clipboard.writeText(copyString).then(() => {\n            showToast('Command copied to clipboard.');\n          });\n        }\n      });\n    }\n\n    // Position and show menu\n    contextMenu.style.left = e.originalEvent.pageX + 'px';\n    contextMenu.style.top = e.originalEvent.pageY + 'px';\n    contextMenu.style.display = 'block';\n  });\n\n  const hideMenu = () => (contextMenu.style.display = 'none');\n\n  map.on('mousedown', hideMenu);\n  document.addEventListener('mousedown', hideMenu);\n}\n","import { regionBounds } from './config.js';\n\nimport { overlays } from './layers.js';\n\nexport function enableGpxDragAndDrop(map, layersControl) {\n  const mapContainer = map.getContainer();\n  const bounds = L.latLngBounds(regionBounds);\n\n  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n    mapContainer.addEventListener(eventName, e => e.preventDefault(), false);\n  });\n\n  mapContainer.addEventListener('drop', e => {\n    e.preventDefault();\n    if (!e.dataTransfer.files.length) return;\n\n    for (const file of e.dataTransfer.files) {\n      if (!file.name.toLowerCase().endsWith('.gpx')) continue;\n\n      const reader = new FileReader();\n      reader.onload = event => {\n        const gpxText = event.target.result;\n        const gpxLayer = new L.GPX(gpxText, {\n          async: true,\n          polyline_options: {\n            color: '#9400D3',\n            weight: 5,\n            opacity: 0.7,\n          },\n          gpx_options: {\n            joinTrackSegments: false,\n          },\n          markers: {\n            startIcon: null,\n            endIcon: null,\n          },\n        });\n\n        gpxLayer.on('loaded', () => {\n          const gpxBounds = gpxLayer.getBounds();\n          if (bounds.intersects(gpxBounds)) {\n            gpxLayer.addTo(map);\n\n            // Add to overlays and control\n            const name = file.name.replace(/\\.gpx$/i, '');\n            overlays[name] = gpxLayer;\n            layersControl.addOverlay(gpxLayer, name);\n\n            map.fitBounds(gpxBounds);\n          } else {\n            alert(\n              `GPX file \"${file.name}\" is outside the allowed bounds and will not be displayed.`\n            );\n          }\n        });\n      };\n      reader.readAsText(file);\n    }\n  });\n}\n","import { isDev } from './config.js';\nimport { mainOverlay, mainOverlayDev } from './layers.js';\n\nexport function addKeyboardShortcuts(map) {\n  function reverseOverlays() {\n    const el = document.getElementById('map');\n    if (mainOverlay.options.opacity === 1) {\n      mainOverlay.setOpacity(0);\n      el.classList.remove('hide-overlays');\n    } else {\n      mainOverlay.setOpacity(1);\n      // el.classList.add('hide-overlays');\n    }\n  }\n  function toggleOverlays(all = false) {\n    const el = document.getElementById('map');\n    if (el.classList.contains('hide-overlays')) {\n      // If overlays are hidden, show them\n      el.classList.remove('hide-overlays');\n      mainOverlay.setOpacity(1);\n    } else {\n      el.classList.toggle('hide-overlays'); // toggles the 'hidden' class on/off\n      mainOverlay.setOpacity(all ? 0 : 1);\n    }\n  }\n\n  function toggleSatellite() {\n    const slider = document.querySelector('.transparency-slider');\n    if (!slider) return;\n\n    const current = parseInt(slider.value, 10);\n    slider.value = current === 100 ? '0' : '100';\n\n    // Trigger the input event so it behaves reactively\n    slider.dispatchEvent(new Event('input', { bubbles: true }));\n  }\n\n  function toggleMainOverlay() {\n    if (!isDev) return;\n\n    if (map.hasLayer(mainOverlay)) {\n      map.removeLayer(mainOverlay);\n      map.addLayer(mainOverlayDev);\n    } else if (map.hasLayer(mainOverlayDev)) {\n      map.removeLayer(mainOverlayDev);\n      map.addLayer(mainOverlay);\n    }\n  }\n\n  document.addEventListener('keydown', e => {\n    const active = document.activeElement;\n    if (\n      active &&\n      (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)\n    )\n      return;\n\n    if (e.key.toLowerCase() === 'a') {\n      toggleOverlays(true);\n    } else if (e.key.toLowerCase() === 'q') {\n      toggleOverlays(false);\n    } else if (e.key.toLowerCase() === 'w') {\n      reverseOverlays();\n    } else if (e.key.toLowerCase() === 's') {\n      toggleSatellite();\n    } else if (e.key === 'Delete') {\n      localStorage.clear();\n      location.reload();\n    } else if (e.key.toLowerCase() === 'e') {\n      toggleMainOverlay();\n    }\n  });\n}\n","export const drawnLines = [];\n\nexport function addHighlightPen(map) {\n  let currentLine = null;\n  let drawing = false;\n\n  const polylineOptions = map => {\n    const zoom = map.getZoom();\n    const baseWeight = 25;\n    const scaledWeight = Math.max(4, baseWeight - (18 - zoom) * 2);\n    return {\n      color: 'yellow',\n      weight: scaledWeight,\n      opacity: 0.3,\n    };\n  };\n\n  const controls = L.control({ position: 'bottomleft' });\n\n  controls.onAdd = function () {\n    const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control');\n\n    const drawBtn = L.DomUtil.create('a', '', container);\n    drawBtn.href = '#';\n    drawBtn.innerHTML = '🖊️';\n    drawBtn.title = 'Toggle highlighter';\n    drawBtn.style.padding = '6px 10px';\n    drawBtn.style.fontSize = '20px';\n\n    const clearBtn = L.DomUtil.create('a', '', container);\n    clearBtn.href = '#';\n    clearBtn.innerHTML = '🧽';\n    clearBtn.title = 'Clear highlights';\n    clearBtn.style.padding = '6px 10px';\n    clearBtn.style.fontSize = '20px';\n\n    drawBtn.onclick = e => {\n      e.preventDefault();\n      drawing = !drawing;\n      updateDrawButton();\n    };\n\n    clearBtn.onclick = e => {\n      e.preventDefault();\n      drawnLines.forEach(line => map.removeLayer(line));\n      drawnLines.length = 0;\n      saveToUrl();\n    };\n\n    // ✅ Prevent event bubbling from control to map\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n\n    function updateDrawButton() {\n      if (drawing) {\n        drawBtn.style.background = '#ff0';\n        drawBtn.style.color = 'black';\n      } else {\n        drawBtn.style.background = 'white';\n        drawBtn.style.color = '';\n      }\n    }\n\n    return container;\n  };\n\n  controls.addTo(map);\n\n  function disableMapInteractions() {\n    map.dragging.disable();\n    map.doubleClickZoom.disable();\n    map.boxZoom.disable();\n    map.scrollWheelZoom.disable();\n  }\n\n  function enableMapInteractions() {\n    map.dragging.enable();\n    map.doubleClickZoom.enable();\n    map.boxZoom.enable();\n    map.scrollWheelZoom.enable();\n  }\n\n  function getLatLngFromEvent(e) {\n    if (e.latlng) return e.latlng;\n    if (e.touches && e.touches.length > 0) {\n      return map.containerPointToLatLng(map.mouseEventToContainerPoint(e.touches[0]));\n    }\n    return null;\n  }\n\n  function startDrawing(e) {\n    if (!drawing) return;\n    const latlng = getLatLngFromEvent(e);\n    if (!latlng) return;\n\n    disableMapInteractions();\n\n    currentLine = L.polyline([latlng], polylineOptions(map)).addTo(map);\n    drawnLines.push(currentLine);\n\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  function continueDrawing(e) {\n    if (!drawing || !currentLine) return;\n    const latlng = getLatLngFromEvent(e);\n    if (!latlng) return;\n    currentLine.addLatLng(latlng);\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  function endDrawing(e) {\n    if (drawing && currentLine) {\n      currentLine = null;\n      drawing = false;\n      updateDrawButton();\n      saveToUrl();\n      enableMapInteractions();\n    }\n    if (e.preventDefault) e.preventDefault();\n  }\n\n  // Mouse events\n  map.on('mousedown', startDrawing);\n  map.on('mousemove', continueDrawing);\n  map.on('mouseup', endDrawing);\n\n  // Touch events\n  const mapContainer = map.getContainer();\n  mapContainer.addEventListener('touchstart', startDrawing, { passive: true });\n  mapContainer.addEventListener('touchmove', continueDrawing, {\n    passive: true,\n  });\n  mapContainer.addEventListener('touchend', endDrawing, { passive: true });\n\n  // Adjust stroke width when zoom changes\n  map.on('zoomend', () => {\n    drawnLines.forEach(line => line.setStyle(polylineOptions(map)));\n  });\n\n  // Keyboard shortcuts\n  window.addEventListener('keydown', e => {\n    if (e.key.toLowerCase() === 'd') {\n      drawing = !drawing;\n      updateDrawButton();\n    }\n\n    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'z') {\n      if (drawnLines.length > 0) {\n        const lastLine = drawnLines.pop();\n        map.removeLayer(lastLine);\n        saveToUrl();\n      }\n    }\n  });\n\n  function updateDrawButton() {\n    const drawBtn = document.querySelector('.leaflet-bar a[title=\"Toggle highlighter\"]');\n    if (!drawBtn) return;\n    if (drawing) {\n      drawBtn.style.background = '#ff0';\n      drawBtn.style.color = 'black';\n    } else {\n      drawBtn.style.background = 'white';\n      drawBtn.style.color = '';\n    }\n  }\n\n  function saveToUrl() {\n    if (!drawnLines.length) {\n      updateUrlParam(null);\n      return;\n    }\n\n    const encoded = drawnLines\n      .map(line => polyline.encode(line.getLatLngs().map(p => [p.lat, p.lng])))\n      .join(';');\n\n    updateUrlParam(encoded);\n  }\n\n  function updateUrlParam(value) {\n    const params = new URLSearchParams(window.location.search);\n\n    if (value) {\n      params.set('data', value);\n    } else {\n      params.delete('data');\n    }\n\n    const newUrl =\n      window.location.pathname +\n      (params.toString() ? '?' + params.toString() : '') +\n      window.location.hash;\n\n    window.history.replaceState(null, '', newUrl);\n  }\n\n  function loadFromUrl() {\n    const params = new URLSearchParams(window.location.search);\n    const raw = params.get('data');\n    if (!raw) return;\n\n    const segments = raw.split(';');\n    segments.forEach(encoded => {\n      try {\n        const coords = polyline.decode(encoded).map(([lat, lng]) => L.latLng(lat, lng));\n        const line = L.polyline(coords, polylineOptions(map)).addTo(map);\n        drawnLines.push(line);\n      } catch (e) {\n        console.warn('Invalid polyline segment:', encoded);\n      }\n    });\n  }\n\n  loadFromUrl();\n}\n","import { isDev } from './config.js';\nimport { promptPassword } from './auth.js';\nimport { initializeMap } from './mapSetup.js';\nimport { addLegend } from './legend.js';\nimport { addContextMenu } from './contextMenu.js';\nimport { enableGpxDragAndDrop } from './gpxDragDrop.js';\nimport { addKeyboardShortcuts } from './keyboard.js';\nimport { addHighlightPen } from './draw.js';\nimport { addBaseLayerTransparencyControl } from './transparency.js';\nimport { mainOverlay, mainOverlayDev, baseLayers, satelliteLayers, overlays } from './layers.js';\n\nimport '../css/index.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\tif (isDev) {\n\t\tdocument.title = '🤖' + document.title;\n\t}\n\n\tconst { map, layersControl } = initializeMap();\n\n\taddLegend(map);\n\n\taddContextMenu(map);\n\taddKeyboardShortcuts(map);\n\taddHighlightPen(map);\n\n\tenableGpxDragAndDrop(map, layersControl);\n\taddBaseLayerTransparencyControl(map);\n\n\twindow.addEventListener('load', promptPassword);\n\tdocument.addEventListener('visibilitychange', () => {\n\t\tif (document.visibilityState === 'visible') promptPassword();\n\t});\n});\n"],"names":["isDev","clipBounds","regionBounds","colors","timestamp","minZoom","maxZoom","PASSWORD","STORAGE_KEY_AUTH","ONE_MONTH_MS","isPasswordValid","stored","password","expires","storePassword","promptPassword","mainOverlay","mainOverlayDev","createDRRLayer","attribution","layers","DRR_DYNAMIC_LAYERS","GOOGLE_LAYERS","googleSatellite","googleMaps","googleTerrain","googleHybrid","esriFirefly","esriClarity","esriWayback","thunderforestTransport","thunderforestCycle","osmStandard","worldTopoMap","rtsMap","googleStreetViewTiles","mapillaryVector","kartaViewTiles","stravaHeatmapAll","stravaHeatmapRide","osmGpsTraces","baseLayers","satelliteLayers","overlays","baseLayerTransparency","addBaseLayerTransparencyControl","map","baseControl","div","select","label","option","savedName","defaultName","currentSatelliteLayer","input","e","selectedName","STORAGE_KEY_VIEW","STORAGE_KEY_BASE","STORAGE_KEY_SATELLITE","STORAGE_KEY_OVERLAYS","initializeMap","createMap","setInitialView","layersControl","restoreLayerSelection","setupEventListeners","hashMatch","zoom","lat","lng","saved","center","currentBaseLayer","baseName","overlayJSON","savedOverlays","name","layer","satName","selectedBaseLayer","_","v","selectedSatLayer","activeOverlays","hash","addLegend","legend","container","isVisible","colorBox","color","panel","header","title","collapseBtn","updateVisibility","content","iconBtn","showToast","message","duration","toast","addContextMenu","contextMenu","addMenuItem","action","item","addSeparator","hr","z","params","response","data","elevation","error","bounds","north","west","south","east","bboxString","copyString","hideMenu","enableGpxDragAndDrop","mapContainer","eventName","file","reader","event","gpxText","gpxLayer","gpxBounds","addKeyboardShortcuts","reverseOverlays","el","toggleOverlays","all","toggleSatellite","slider","current","toggleMainOverlay","active","drawnLines","addHighlightPen","currentLine","drawing","polylineOptions","controls","drawBtn","clearBtn","updateDrawButton","line","saveToUrl","disableMapInteractions","enableMapInteractions","getLatLngFromEvent","startDrawing","latlng","continueDrawing","endDrawing","lastLine","updateUrlParam","encoded","p","value","newUrl","loadFromUrl","raw","coords"],"mappings":"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"}